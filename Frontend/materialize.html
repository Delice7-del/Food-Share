<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="FoodShare - Connecting surplus food with those in need">
  <meta name="keywords" content="food donation, food bank, charity, volunteer, food waste">
  <meta name="author" content="FoodShare">
  <meta property="og:title" content="FoodShare - Food Donation Platform">
  <meta property="og:description" content="Connect with local charities and food banks to donate surplus food">
  <meta property="og:type" content="website">
  <title>FoodShare - Food Donation Platform</title>
  

  <link rel="icon" type="image/png" href="favicon.png">
  
 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
 
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  
  <style>
    :root {
      --primary-color: #4CAF50;
      --secondary-color: #2E7D32;
    }

    body {
      background-color: #f5f5f5;
      display: flex;
      min-height: 100vh;
      flex-direction: column;
    }

    main {
      flex: 1 0 auto;
    }

    nav {
      margin-bottom: 0;
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    }

    .section {
      padding: 40px 0;
    }

    .card {
      border-radius: 8px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 17px 2px rgba(0,0,0,0.14), 
                 0 3px 14px 2px rgba(0,0,0,0.12), 
                 0 5px 5px -3px rgba(0,0,0,0.2);
    }

    .card .card-content {
      padding: 24px;
    }

    .collection {
      border-radius: 8px;
    }

    .btn, .btn-large {
      border-radius: 25px;
      text-transform: none;
      margin: 5px;
    }

    .chip {
      margin: 5px;
    }

    .page-footer {
      background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
      margin-top: 0;
    }

    .hero {
      background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://source.unsplash.com/random/1920x1080/?food') center/cover;
      height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-align: center;
    }

    .hero h1 {
      font-size: 3.5rem;
      margin-bottom: 1rem;
    }

    .hero p {
      font-size: 1.5rem;
      margin-bottom: 2rem;
    }

    .food-map {
      height: 400px;
      border-radius: 8px;
      margin: 20px 0;
    }

    .food-item {
      padding: 10px;
      margin: 5px 0;
      border-radius: 4px;
      background-color: #fff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .food-item .expiry-date {
      color: #e53935;
      font-weight: bold;
    }

    .volunteer-card {
      text-align: center;
    }

    .volunteer-card img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin-bottom: 10px;
    }

    .social-links a {
      margin: 0 10px;
      color: white;
      transition: opacity 0.3s ease;
    }

    .social-links a:hover {
      opacity: 0.8;
    }

    .loading {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 9999;
    }

    .loading .preloader-wrapper {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }



    @media only screen and (max-width: 600px) {
      .hero h1 {
        font-size: 2.5rem;
      }
      .hero p {
        font-size: 1.2rem;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Indicator -->
  <div class="loading">
    <div class="preloader-wrapper big active">
      <div class="spinner-layer spinner-green-only">
        <div class="circle-clipper left">
          <div class="circle"></div>
        </div>
        <div class="gap-patch">
          <div class="circle"></div>
        </div>
        <div class="circle-clipper right">
          <div class="circle"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Navbar -->
  <nav>
    <div class="nav-wrapper container">
      <a href="#" class="brand-logo">FoodShare</a>
      <a href="#" data-target="mobile-nav" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
        <li><a href="#home">Home</a></li>
        <li><a href="#donate">Donate Food</a></li>
        <li><a href="#volunteer">Volunteer</a></li>
        <li><a href="#map">Food Map</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- Mobile Navigation -->
  <ul class="sidenav" id="mobile-nav">
    <li><a href="#home">Home</a></li>
    <li><a href="#donate">Donate Food</a></li>
    <li><a href="#volunteer">Volunteer</a></li>
    <li><a href="#map">Food Map</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>

  <!-- Hero Section -->
  <section id="home" class="hero">
    <div class="container">
      <h1>Share Food, Share Hope</h1>
      <p>Connect surplus food with those who need it most</p>
      <a href="#donate" class="btn-large waves-effect waves-light">Donate Now</a>
    </div>
  </section>

 
  <main>
    <div class="container">
      <!-- Donation Section -->
      <section id="donate" class="section">
        <h2 class="header center-align">Donate Food</h2>
        

        
        <div class="row">
          <div class="col s12 m6">
            <div class="card">
              <div class="card-content">
                <span class="card-title">Available Food Items</span>
                <div class="food-item">
                  <h5>Fresh Vegetables</h5>
                  <p>Quantity: 50 kg</p>
                  <p class="expiry-date">Expires: 2 days</p>
                  <a class="btn waves-effect waves-light">Schedule Pickup</a>
                </div>
                <div class="food-item">
                  <h5>Canned Goods</h5>
                  <p>Quantity: 100 cans</p>
                  <p>Expires: 6 months</p>
                  <a class="btn waves-effect waves-light">Schedule Pickup</a>
                </div>
                <div class="food-item">
                  <h5>Bakery Items</h5>
                  <p>Quantity: 30 kg</p>
                  <p class="expiry-date">Expires: 1 day</p>
                  <a class="btn waves-effect waves-light">Schedule Pickup</a>
                </div>
              </div>
            </div>
          </div>
          <div class="col s12 m6">
            <div class="card">
              <div class="card-content">
                <span class="card-title">Add New Donation</span>
                <form id="donationForm">
                  <div class="input-field">
                    <input id="food_name" type="text" class="validate" required>
                    <label for="food_name">Food Item Name</label>
                  </div>
                  <div class="input-field">
                    <input id="quantity" type="number" class="validate" required>
                    <label for="quantity">Quantity (kg/cans)</label>
                  </div>
                  <div class="input-field">
                    <input id="expiry" type="date" class="validate" required>
                    <label for="expiry">Expiry Date</label>
                  </div>
                  <div class="input-field">
                    <textarea id="description" class="materialize-textarea"></textarea>
                    <label for="description">Description</label>
                  </div>
                  <button class="btn waves-effect waves-light" type="submit">
                    Add Donation
                    <i class="material-icons right">add</i>
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Volunteer Section -->
      <section id="volunteer" class="section">
        <h2 class="header center-align">Volunteer Opportunities</h2>
        

        
        <div class="row">
          <div class="col s12 m4">
            <div class="card volunteer-card">
              <div class="card-content">
                <img src="https://source.unsplash.com/random/100x100/?volunteer" alt="Volunteer">
                <span class="card-title">Food Collection</span>
                <p>Help collect and transport food donations from local businesses.</p>
                <a class="btn waves-effect waves-light">Sign Up</a>
              </div>
            </div>
          </div>
          <div class="col s12 m4">
            <div class="card volunteer-card">
              <div class="card-content">
                <img src="https://source.unsplash.com/random/100x100/?distribution" alt="Distribution">
                <span class="card-title">Food Distribution</span>
                <p>Assist in sorting and distributing food to local charities.</p>
                <a class="btn waves-effect waves-light">Sign Up</a>
              </div>
            </div>
          </div>
          <div class="col s12 m4">
            <div class="card volunteer-card">
              <div class="card-content">
                <img src="https://source.unsplash.com/random/100x100/?coordination" alt="Coordination">
                <span class="card-title">Coordination</span>
                <p>Help coordinate pickups and deliveries between donors and recipients.</p>
                <a class="btn waves-effect waves-light">Sign Up</a>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Food Map Section -->
      <section id="map" class="section">
        <h2 class="header center-align">Food Map</h2>
        <div class="card">
          <div class="card-content">
            <div id="foodMap" class="food-map"></div>
          </div>
        </div>
      </section>

      <!-- Contact Section -->
      <section id="contact" class="section">
        <h2 class="header center-align">Contact Us</h2>
        <div class="row">
          <form id="contactForm" class="col s12">
            <div class="row">
              <div class="input-field col s6">
                <i class="material-icons prefix">account_circle</i>
                <input id="first_name" type="text" class="validate" required>
                <label for="first_name">First Name</label>
                <span class="helper-text" data-error="Please enter your first name"></span>
              </div>
              <div class="input-field col s6">
                <i class="material-icons prefix">phone</i>
                <input id="telephone" type="tel" class="validate" required>
                <label for="telephone">Telephone</label>
                <span class="helper-text" data-error="Please enter a valid phone number"></span>
              </div>
            </div>
            <div class="row">
              <div class="input-field col s12">
                <i class="material-icons prefix">email</i>
                <input id="email" type="email" class="validate" required>
                <label for="email">Email</label>
                <span class="helper-text" data-error="Please enter a valid email address"></span>
              </div>
            </div>
            <div class="row">
              <div class="input-field col s12">
                <i class="material-icons prefix">message</i>
                <textarea id="message" class="materialize-textarea" required></textarea>
                <label for="message">Message</label>
                <span class="helper-text" data-error="Please enter your message"></span>
              </div>
            </div>
            <div class="row">
              <div class="col s12 center-align">
                <button class="btn-large waves-effect waves-light" type="submit">
                  Submit
                  <i class="material-icons right">send</i>
                </button>
              </div>
            </div>
          </form>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="page-footer">
    <div class="container">
      <div class="row">
        <div class="col s12 m6">
          <h5 class="white-text">FoodShare</h5>
          <p class="grey-text text-lighten-4">Connecting surplus food with those in need.</p>
        </div>
        <div class="col s12 m6">
          <h5 class="white-text">Connect With Us</h5>
          <div class="social-links">
            <a href="#"><i class="material-icons">facebook</i></a>
            <a href="#"><i class="material-icons">twitter</i></a>
            <a href="#"><i class="material-icons">linkedin</i></a>
            <a href="#"><i class="material-icons">email</i></a>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
        © 2024 FoodShare
        <a class="grey-text text-lighten-4 right" href="#!">Privacy Policy</a>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
     
      M.AutoInit();
      
      // API Configuration
      const API_BASE_URL = 'http://localhost:5002/api';
      

      

      

      

      

      
      // Initialize the map
      const map = L.map('foodMap').setView([51.505, -0.09], 13);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
      }).addTo(map);

      // Sample donations (will be replaced by API data)
      const donations = [
        { lat: 51.505, lng: -0.09, title: 'Fresh Vegetables', type: 'donation' },
        { lat: 51.51, lng: -0.1, title: 'Canned Goods', type: 'donation' },
        { lat: 51.515, lng: -0.095, title: 'Bakery Items', type: 'donation' }
      ];

      donations.forEach(donation => {
        const marker = L.marker([donation.lat, donation.lng])
          .bindPopup(`<b>${donation.title}</b><br>Available for pickup`)
          .addTo(map);
      });

      // Form submission handling
      const contactForm = document.getElementById('contactForm');
      const donationForm = document.getElementById('donationForm');
      const loading = document.querySelector('.loading');

      // Add click handlers for Schedule Pickup buttons
      function addPickupHandlers() {
        const pickupButtons = document.querySelectorAll('.btn.waves-effect.waves-light');
        pickupButtons.forEach(button => {
          if (button.textContent.includes('Schedule Pickup')) {
            button.addEventListener('click', function(e) {
              e.preventDefault();
              const foodItem = this.closest('.food-item');
              const foodName = foodItem.querySelector('h5').textContent;
              const quantity = foodItem.querySelector('p').textContent;
              const expiry = foodItem.querySelector('.expiry-date')?.textContent || 'Unknown expiry';
              
              // Show pickup scheduling modal
              M.toast({
                html: `Scheduling pickup for ${foodName}. This feature will be available when you log in.`,
                classes: 'blue',
                displayLength: 4000
              });
              
              // For demo purposes, show a success message after a delay
              setTimeout(() => {
                M.toast({
                  html: `Pickup scheduled for ${foodName}! A volunteer will contact you soon.`,
                  classes: 'green',
                  displayLength: 5000
                });
              }, 2000);
            });
          }
        });
      }

      // Add click handlers for Sign Up buttons
      function addSignupHandlers() {
        const signupButtons = document.querySelectorAll('.volunteer-card .btn');
        signupButtons.forEach(button => {
          button.addEventListener('click', function(e) {
            e.preventDefault();
            const card = this.closest('.volunteer-card');
            const role = card.querySelector('.card-title').textContent;
            
            // Show signup modal
            M.toast({
              html: `Signing up for ${role}. This feature will be available when you log in.`,
              classes: 'blue',
              displayLength: 4000
            });
            
            // For demo purposes, show a success message after a delay
            setTimeout(() => {
              M.toast({
                html: `Successfully signed up for ${role}! We'll contact you soon.`,
                classes: 'green',
                displayLength: 5000
              });
            }, 2000);
          });
        });
      }

      // Contact form submission
      contactForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        loading.style.display = 'block';

        try {
          const formData = {
            firstName: document.getElementById('first_name').value,
            lastName: 'Anonymous', // Default last name if not present in form
            email: document.getElementById('email').value,
            phone: document.getElementById('telephone').value,
            subject: 'Contact Form Submission',
            message: document.getElementById('message').value,
            category: 'general'
          };

          // Try to send to backend
          const response = await fetch(`${API_BASE_URL}/contact`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
          });

          if (response.ok) {
          M.toast({html: 'Message sent successfully!', classes: 'green'});
          contactForm.reset();
          } else {
            const error = await response.json();
            M.toast({html: `Error: ${error.message || 'Failed to send message'}`, classes: 'red'});
          }
        } catch (error) {
          console.error('Contact form error:', error);
          
          // Check if it's a network error (backend not running)
          if (error.name === 'TypeError' && error.message.includes('fetch')) {
            M.toast({
              html: 'Backend server is not running. Please start the server and try again.',
              classes: 'orange',
              displayLength: 6000
            });
          } else {
              M.toast({
              html: 'Error sending message. Please try again.',
              classes: 'red',
                displayLength: 5000
              });
          }
        } finally {
          loading.style.display = 'none';
        }
      });

      // Donation form submission
      donationForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        loading.style.display = 'block';

        try {
          const formData = {
            title: document.getElementById('food_name').value,
            description: document.getElementById('description').value || '',
            category: 'other', // Default category
            quantity: {
              amount: parseFloat(document.getElementById('quantity').value),
              unit: 'kg'
            },
            expiryDate: document.getElementById('expiry').value,
            pickupDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString().split('T')[0], // Tomorrow
            pickupTime: {
              start: '09:00',
              end: '17:00'
            },
            location: {
              coordinates: [51.505, -0.09], // Default coordinates (London)
              address: {
                street: 'Sample Street',
                city: 'London',
                state: 'England',
                zipCode: 'SW1A 1AA',
                country: 'United Kingdom'
              }
            }
          };

            // Try to send to backend
              const response = await fetch(`${API_BASE_URL}/donations`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
              });
              
              if (response.ok) {
          M.toast({html: 'Donation added successfully!', classes: 'green'});
          donationForm.reset();
                // Refresh the donations display
            try {
              await updateDonationDisplay();
            } catch (updateError) {
              console.error('Error updating display:', updateError);
            }
              } else {
                const error = await response.json();
                M.toast({html: `Error: ${error.message || 'Failed to add donation'}`, classes: 'red'});
              }
            } catch (error) {
          console.error('Donation form error:', error);
          
          // Check if it's a network error (backend not running)
          if (error.name === 'TypeError' && error.message.includes('fetch')) {
            M.toast({
              html: 'Backend server is not running. Please start the server and try again.',
              classes: 'orange',
              displayLength: 6000
            });
          } else {
            M.toast({
              html: 'Error adding donation. Please try again.',
              classes: 'red',
              displayLength: 5000
            });
          }
        } finally {
          loading.style.display = 'none';
        }
      });



      // Function to fetch donations from API
      async function fetchDonations() {
        try {
          const response = await fetch(`${API_BASE_URL}/donations?limit=10`);
          if (response.ok) {
            const data = await response.json();
            return data.data?.donations || data.donations || [];
          } else {
            console.log('API responded with status:', response.status);
            return [];
          }
        } catch (error) {
          console.error('Error fetching donations:', error);
        return [];
        }
      }

      // Function to update donation display
      async function updateDonationDisplay() {
        try {
        const donations = await fetchDonations();
        const donationContainer = document.querySelector('.food-item').parentElement;
        
          if (donations && donations.length > 0) {
          // Clear existing items
          donationContainer.innerHTML = '';
          
          // Add new items from API
          donations.forEach(donation => {
            const donationElement = document.createElement('div');
            donationElement.className = 'food-item';
            donationElement.innerHTML = `
                <h5>${donation.title || 'Food Item'}</h5>
                <p>Quantity: ${donation.quantity?.amount || 'Unknown'} ${donation.quantity?.unit || 'units'}</p>
                <p class="expiry-date">Expires: ${donation.expiryDate ? new Date(donation.expiryDate).toLocaleDateString() : 'Unknown'}</p>
              <a class="btn waves-effect waves-light">Schedule Pickup</a>
            `;
            donationContainer.appendChild(donationElement);
          });
            
            // Add click handlers to new buttons
          addPickupHandlers();
        } else {
            // Show default content if no donations
            console.log('No donations found or API not responding');
          }
        } catch (error) {
          console.error('Error updating donation display:', error);
          // Don't show error to user for display updates
        }
      }


      // Update donations when page loads
      try {
        updateDonationDisplay();
      } catch (error) {
        console.error('Error loading donations on page load:', error);
      }

      // Add event handlers for buttons
      addPickupHandlers();
      addSignupHandlers();

      // Smooth scrolling for navigation links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth'
            });
          }
        });
      });
    });
  </script>
</body>
</html>

/*

The purpose of your Food Share App is to connect people with 
extra food to those who need it, reducing food waste and helping people access free or shared meals easily.
*/


